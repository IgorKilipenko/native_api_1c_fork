# üìñ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

> –ì–∞–π–¥ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å 
> [–∑–¥–µ—Å—å](https://infostart.ru/1c/articles/1920565/) –∏ –∑–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é, –Ω–æ –Ω–µ 
> –æ—Å—Ç–∞–≤–ª—è–π—Ç–µ —Ç–∞–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ–± –æ—à–∏–±–∫–∞—Ö, —Ç.–∫. —Ç–∞–º —Å–ª–æ–∂–Ω–æ —ç—Ç–æ –æ–±—Å—É–∂–¥–∞—Ç—å. –õ—É—á—à–µ —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —ç—Ç–æ–º 
> —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

## üÜï –ù–æ–≤—ã–µ —É–ø—Ä–æ—â–µ–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –¥–ª—è –ª—É—á—à–µ–≥–æ –æ–ø—ã—Ç–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

## üÜï –ù–æ–≤—ã–µ VARIANT —Ç–∏–ø—ã

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö 1C Native API:

### –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã
```rust
#[prop(ty = Bool, name = "MyBool")]
pub my_bool: bool,

#[prop(ty = Int32, name = "MyInt32")]
pub my_int32: i32,

#[prop(ty = Double, name = "MyDouble")]
pub my_double: f64,

#[prop(ty = Date, name = "MyDate")]
pub my_date: f64, // Windows DATE format
```

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã
```rust
#[prop(ty = I8, name = "MyI8")]
pub my_i8: i8,

#[prop(ty = I16, name = "MyI16")]
pub my_i16: i16,

#[prop(ty = I64, name = "MyI64")]
pub my_i64: i64,

#[prop(ty = U8, name = "MyU8")]
pub my_u8: u8,

#[prop(ty = U16, name = "MyU16")]
pub my_u16: u16,

#[prop(ty = U32, name = "MyU32")]
pub my_u32: u32,

#[prop(ty = U64, name = "MyU64")]
pub my_u64: u64,
```

### –ß–∏—Å–ª–∞ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
```rust
#[prop(ty = F32, name = "MyF32")]
pub my_f32: f32,
```

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã
```rust
#[prop(ty = Error, name = "MyError")]
pub my_error: i32,

#[prop(ty = ClsId, name = "MyClsId")]
pub my_cls_id: [u8; 16], // UUID/GUID
```

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
```rust
// –ü—É—Å—Ç–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ)
#[prop(ty = Empty, name = "MyEmpty")]
pub my_empty: (),

// NULL –∑–Ω–∞—á–µ–Ω–∏–µ
#[prop(ty = Null, name = "MyNull")]
pub my_null: (),
```

### –°–≤–æ–π—Å—Ç–≤–∞
```rust
#[prop(ty = Int, name = "MyProp", ru = "–ú–æ–µ–°–≤–æ–π—Å—Ç–≤–æ", readable, writable)]
pub my_property: i32,
```

### –§—É–Ω–∫—Ü–∏–∏
```rust
#[func(name = "MyFunction", ru = "–ú–æ—è–§—É–Ω–∫—Ü–∏—è")]
#[param(ty = Int)]
#[param(ty = Int, default = 12)]
#[return_type(ty = Int, result)]
pub my_function: fn(&Self, i32, i32) -> Result<i32, NativeApiError>,
```

### –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
```rust
#[connection]
connection: Arc<Option<&'static Connection>>,
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–±–µ—Ä—Ç–∫–∏

### SafeVariant
–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å TVariant:

```rust
use native_api_1c_core::safe_wrappers::SafeVariant;

// –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏
let mut variant = SafeVariant::new();

// –ë—É–ª–µ–≤—ã –∑–Ω–∞—á–µ–Ω–∏—è
variant.set_bool(true);
assert_eq!(variant.get_bool().unwrap(), true);

// –¶–µ–ª—ã–µ —á–∏—Å–ª–∞
variant.set_i32(42);
assert_eq!(variant.get_i32().unwrap(), 42);

// –ß–∏—Å–ª–∞ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
variant.set_f64(3.14159);
assert_eq!(variant.get_f64().unwrap(), 3.14159);

// –î–∞—Ç—ã
variant.set_date(44197.0);
assert_eq!(variant.get_date().unwrap(), 44197.0);

// –ö–æ–¥—ã –æ—à–∏–±–æ–∫
variant.set_error(1001);
assert_eq!(variant.get_error().unwrap(), 1001);

// CLSID (UUID/GUID)
let cls_id = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16];
variant.set_cls_id(cls_id);
assert_eq!(variant.get_cls_id().unwrap(), cls_id);

// NULL –∑–Ω–∞—á–µ–Ω–∏—è
variant.set_null();
assert!(variant.is_null());
```

### SafeVariantArray
–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –º–∞—Å—Å–∏–≤–∞–º–∏ TVariant:

```rust
use native_api_1c_core::safe_wrappers::{SafeVariant, SafeVariantArray};

let mut array = SafeVariantArray::new();

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
let mut variant1 = SafeVariant::new();
variant1.set_i32(100);
array.push(variant1);

let mut variant2 = SafeVariant::new();
variant2.set_bool(true);
array.push(variant2);

// –ü–æ–ª—É—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
assert_eq!(array.len(), 2);
let first = array.get(0).unwrap();
assert_eq!(first.get_i32().unwrap(), 100);

let second = array.get(1).unwrap();
assert_eq!(second.get_bool().unwrap(), true);
```

## –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∞—Ç—Ä–∏–±—É—Ç—ã (–≤—Å–µ –µ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è)

### –ê—Ç—Ä–∏–±—É—Ç—ã `#[add_in_prop(...)]`
- `name` - –∏–º—è —Å–≤–æ–π—Å—Ç–≤–∞ –≤ 1C
- `name_ru` - –∏–º—è —Å–≤–æ–π—Å—Ç–≤–∞ –≤ 1C –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- `readable` - —Å–≤–æ–π—Å—Ç–≤–æ –¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —á—Ç–µ–Ω–∏—è –∏–∑ 1C
- `writable` - —Å–≤–æ–π—Å—Ç–≤–æ –¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –∑–∞–ø–∏—Å–∏ –∏–∑ 1C

–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∏–ø—ã —Å–≤–æ–π—Å—Ç–≤: `i32`, `f64`, `bool`, `String`

## –§—É–Ω–∫—Ü–∏–∏ –∏–ª–∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã `#[add_in_func(...)]`
- `name` - –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏ –≤ 1C
- `name_ru` - –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏ –≤ 1C –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

### –í—Ö–æ–¥–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, `#[arg(ty = ...)]`, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É–∫–∞–∑–∞–Ω–æ, –æ–¥–Ω–æ –∏–∑:

| –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ | –¢–∏–ø Rust               | –¢–∏–ø 1C                 |
|-----------------|------------------------|------------------------|
| `Int`           | `i32`                   | `Number` (Int)          |
| `Float`         | `f64`                   | `Number` (Float or Int) |
| `Bool`          | `bool`                  | `Boolean`               |
| `Str`           | `String`                | `String`                |
| `Date`          | `chrono::NaiveDateTime` | `Date`                  |
| `Blob`          | `Vec<u8>`               | `BinaryData`            |

### –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, `#[returns(ty = ...)]`, —Ç–∏–ø –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞–Ω, –æ–¥–∏–Ω –∏–∑:

| –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ | –¢–∏–ø Rust               | –¢–∏–ø 1C      |
|-----------------|------------------------|-------------|
| `Int`           | `i32`                   | `Number`     |
| `Float`         | `f64`                   | `Number`     |
| `Bool`          | `bool`                  | `Boolean`    |
| `Str`           | `String`                | `String`     |
| `Date`          | `chrono::NaiveDateTime` | `Date`       |
| `Blob`          | `Vec<u8>`               | `BinaryData` |
| `None`          | `()`                    | `Undefined`  |

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Result<T, NativeApiError>`, –≥–¥–µ `T` - –æ–¥–∏–Ω –∏–∑ –≤—ã—à–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –≤ –∞—Ç—Ä–∏–±—É—Ç–µ `#[returns(...)]` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É–∫–∞–∑–∞–Ω–æ `result`: `#[returns(Int, result)]` –¥–ª—è `Result<i32, NativeApiError>`

## üÜï –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ç–µ–ø–µ—Ä—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –æ—à–∏–±–æ–∫:

```rust
use native_api_1c_core::errors::NativeApiError;

// –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫:
// - PropertyError: –û—à–∏–±–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–æ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ (–Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è, –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è)
// - MethodError: –û—à–∏–±–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –º–µ—Ç–æ–¥–∞–º–∏ (–Ω–µ –Ω–∞–π–¥–µ–Ω, –æ—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –Ω–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
// - MemoryError: –û—à–∏–±–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é
// - InitializationError: –û—à–∏–±–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
// - ParameterError: –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
// - TypeConversionError: –û—à–∏–±–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤

fn my_function(&self, arg: i32) -> Result<i32, NativeApiError> {
    if arg < 0 {
        return Err(ParameterError::invalid_value("–ê—Ä–≥—É–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º").into());
    }
    Ok(arg * 2)
}
```

## –ü—Ä–∏–º–µ—Ä

```toml
# Cargo.toml
[package]
name = "my_addin"
version = "0.1.0"
edition = "2021"

[lib]
crate-type = ["cdylib"]

[dependencies]
utf16_lit = "2.0"
# –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–± - —á–µ—Ä–µ–∑ –Ω–∞—à —Ñ–æ—Ä–∫ —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏
native_api_1c = { git = "https://github.com/IgorKilipenko/native_api_1c_fork.git", branch = "main" }
# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ - –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
# native_api_1c = "0.10.5"
```

```rust
// src/lib.rs
use std::sync::Arc;

use native_api_1c::{
    native_api_1c_core::{
        errors::NativeApiError,
        ffi::connection::Connection,
    },
    native_api_1c_macro::{extern_functions, AddIn},
};

#[derive(AddIn)]
pub struct SampleAddIn {
    /// —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å 1C, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–∑–æ–≤–∞ —Å–æ–±—ã—Ç–∏–π
    /// Arc –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Ç–æ–∫–æ–≤
    #[connection] // –ù–æ–≤—ã–π —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç
    connection: Arc<Option<&'static Connection>>,

    /// –°–≤–æ–π—Å—Ç–≤–æ, –¥–æ—Å—Ç—É–ø–Ω–æ–µ –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏ –∏–∑ 1C
    #[prop(ty = Int, name = "MyProp", ru = "–ú–æ–µ–°–≤–æ–π—Å—Ç–≤–æ", readable, writable)] // –ù–æ–≤—ã–π —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç
    pub some_prop: i32,

    /// –°–≤–æ–π—Å—Ç–≤–æ, –¥–æ—Å—Ç—É–ø–Ω–æ–µ –¥–ª—è —á—Ç–µ–Ω–∏—è –∏–∑ 1C, –Ω–æ –Ω–µ –¥–ª—è –∑–∞–ø–∏—Å–∏
    #[prop(ty = Int, name = "ProtectedProp", ru = "–ó–∞—â–∏—â–µ–Ω–Ω–æ–µ–°–≤–æ–π—Å—Ç–≤–æ", readable)] // –ù–æ–≤—ã–π —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç
    pub protected_prop: i32,

    /// –§—É–Ω–∫—Ü–∏—è, –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è –æ–¥–∏–Ω –∏–ª–∏ –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    /// –í 1C –æ–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω–∞ –∫–∞–∫:
    /// ```bsl
    ///  CompObj.MyFunction(10, 15); // 2-–π –∞—Ä–≥—É–º–µ–Ω—Ç = 15
    ///  CompObj.MyFunction(10);     // 2-–π –∞—Ä–≥—É–º–µ–Ω—Ç = 12 (–∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
    /// ```
    /// –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É, –Ω–æ –Ω–µ –ø–∞–Ω–∏–∫—É–µ—Ç, —Ç–æ 1C –≤—ã–±—Ä–æ—Å–∏—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
    #[func(name = "MyFunction", ru = "–ú–æ—è–§—É–Ω–∫—Ü–∏—è")] // –ù–æ–≤—ã–π —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç
    #[param(ty = Int)] // –ù–æ–≤—ã–π —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç
    #[param(ty = Int, default = 12)] // –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞
    #[return_type(ty = Int, result)] // –ù–æ–≤—ã–π —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç
    pub my_function: fn(&Self, i32, i32) -> Result<i32, NativeApiError>, // –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

    /// –§—É–Ω–∫—Ü–∏—è, –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è —Å—Ç—Ä–æ–∫—É
    #[func(name = "GetString", ru = "–ü–æ–ª—É—á–∏—Ç—å–°—Ç—Ä–æ–∫—É")] // –ù–æ–≤—ã–π —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç
    #[return_type(ty = Str)] // –ù–æ–≤—ã–π —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç
    pub get_string: fn(&mut Self) -> String,

    /// –ü—Ä–æ—Ü–µ–¥—É—Ä–∞, –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∏ –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è
    #[func(name = "MyProcedure", ru = "–ú–æ—è–ü—Ä–æ—Ü–µ–¥—É—Ä–∞")] // –ù–æ–≤—ã–π —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç
    pub my_procedure: fn(&mut Self),

    /// –ü—Ä–∏–≤–∞—Ç–Ω–æ–µ –ø–æ–ª–µ, –Ω–µ –≤–∏–¥–∏–º–æ–µ –∏–∑ 1C
    private_field: i32,
}

impl Default for SampleAddIn {
    fn default() -> Self {
        Self {
            connection: Arc::new(None),
            some_prop: 0,
            protected_prop: 50,
            my_function: Self::my_function_inner,
            get_string: Self::get_string_inner,
            my_procedure: Self::my_procedure_inner,
            private_field: 100,
        }
    }
}

impl SampleAddIn {
    fn my_function_inner(&self, arg: i32, arg_maybe_default: i32) -> Result<i32, NativeApiError> {
        // –ü—Ä–∏–º–µ—Ä —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
        if arg < 0 {
            return Err(NativeApiError::operation("–ü–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º"));
        }
        
        Ok(self.protected_prop
            + self.some_prop
            + arg
            + self.private_field
            + arg_maybe_default)
    }

    fn get_string_inner(&mut self) -> String {
        self.protected_prop += 10;
        "–ö–∞–∫–∞—è-—Ç–æ —Å—Ç—Ä–æ–∫–∞ –∏–∑ rust".to_string()
    }

    fn my_procedure_inner(&mut self) {
        self.protected_prop += 5;
    }
}

extern_functions! {
    SampleAddIn::default(),
}
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

–ú–µ—Ç–æ–¥ `extern_functions!` –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```rust
extern_functions! {
    SampleAddIn::default(),
    AnotherAddIn::default(),
    YetAnotherAddIn::default(),
}
```

–≠—Ç–∏ –æ–±—ä–µ–∫—Ç—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ç—Ä–µ–π—Ç `AddIn`. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ª–∏–±–æ —Å –ø–æ–º–æ—â—å—é `#[derive(AddIn)]`, –ª–∏–±–æ –≤—Ä—É—á–Ω—É—é. –ü–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ–ª–µ–∑–Ω–æ, –∫–æ–≥–¥–∞ –≤–∞–º –Ω—É–∂–Ω–æ –Ω–µ–æ–±—ã—á–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ–ª—å–∑—è –≤—ã–≤–µ—Å—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## üÜï –ü–æ—Å–ª–µ–¥–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫** —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –æ—à–∏–±–æ–∫ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **–õ—É—á—à–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –æ—à–∏–±–æ–∫** –ø–æ –≤—Å–µ–º—É –∫–æ–¥—É
- **–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö** –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –æ—Ç–ª–∞–¥–∫–∏

### –£–ø—Ä–æ—â–µ–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã
- **–ù–æ–≤—ã–µ –∫–æ—Ä–æ—Ç–∫–∏–µ –∏–º–µ–Ω–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤** –¥–ª—è –ª—É—á—à–µ–≥–æ –æ–ø—ã—Ç–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ `#[add_in_*]`
- **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π –ø—É—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏** –∫ –Ω–æ–≤–æ–º—É —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É

### –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **73 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–∞** –ø–æ–∫—Ä—ã–≤–∞—é—â–∏—Ö –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ mock-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏** –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö FFI –≤—ã–∑–æ–≤–æ–≤ –≤–æ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **100% –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏** –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –º–∞–∫—Ä–æ—Å–æ–≤
- **–£–ª—É—á—à–µ–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞** —Å –ª—É—á—à–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π
- **–ë–∞–∑–æ–≤—ã–µ —Ç—Ä–µ–π—Ç—ã** –¥–ª—è —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–æ–≤
- **–ü–æ–≤—ã—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å

## –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏

### –û—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∫ –Ω–æ–≤—ã–º –∞—Ç—Ä–∏–±—É—Ç–∞–º

| –£—Å—Ç–∞—Ä–µ–≤—à–∏–π | –ù–æ–≤—ã–π | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|------------|-------|------------|
| `#[add_in_prop]` | `#[prop]` | –ë–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å |
| `#[add_in_func]` | `#[func]` | –ë–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å |
| `#[add_in_con]` | `#[connection]` | –ë–æ–ª–µ–µ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–π |
| `#[arg]` | `#[param]` | –ë–æ–ª–µ–µ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–π |
| `#[returns]` | `#[return_type]` | –ë–æ–ª–µ–µ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–π |
| `name_ru` | `ru` | –ë–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–æ–µ –∏–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ |

### –û—Ç –æ–±—â–∏—Ö –æ—à–∏–±–æ–∫ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –æ—à–∏–±–∫–∞–º

```rust
// –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–±
fn my_function(&self, arg: i32) -> Result<i32, ()> {
    if arg < 0 {
        return Err(());
    }
    Ok(arg * 2)
}

// –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–±
use native_api_1c_core::errors::NativeApiError;

fn my_function(&self, arg: i32) -> Result<i32, NativeApiError> {
    if arg < 0 {
        return Err(NativeApiError::operation("–ê—Ä–≥—É–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º"));
    }
    Ok(arg * 2)
}
```
