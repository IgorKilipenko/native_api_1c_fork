# üöÄ –ü–ª–∞–Ω –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ VARIANT —Ç–∏–ø–æ–≤ –∏–∑ 1C Native API

## üìã **–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è**

### ‚úÖ **–£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `VTYPE_EMPTY` ‚Üí `ParamValue::Empty` (–Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
- `VTYPE_NULL` ‚Üí `ParamValue::Null` (—è–≤–Ω–æ–µ NULL –∑–Ω–∞—á–µ–Ω–∏–µ)
- `VTYPE_BOOL` ‚Üí `ParamValue::Bool`
- `VTYPE_I4` (Int32) ‚Üí `ParamValue::I32`
- `VTYPE_R8` (Double) ‚Üí `ParamValue::F64`
- `VTYPE_TM` (Time) ‚Üí `ParamValue::Date`
- `VTYPE_PWSTR` (WStr) ‚Üí `ParamValue::String`
- `VTYPE_BLOB` ‚Üí `ParamValue::Blob`

### ‚úÖ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `VTYPE_I1` (Int8) ‚Üí `ParamValue::I8` - 8-–±–∏—Ç–Ω–æ–µ —Ü–µ–ª–æ–µ
- `VTYPE_I2` (Int16) ‚Üí `ParamValue::I16` - 16-–±–∏—Ç–Ω–æ–µ —Ü–µ–ª–æ–µ
- `VTYPE_UI1` (UInt8) ‚Üí `ParamValue::U8` - –±–µ–∑–∑–Ω–∞–∫–æ–≤–æ–µ 8-–±–∏—Ç–Ω–æ–µ
- `VTYPE_UI2` (UInt16) ‚Üí `ParamValue::U16` - –±–µ–∑–∑–Ω–∞–∫–æ–≤–æ–µ 16-–±–∏—Ç–Ω–æ–µ
- `VTYPE_UI4` (UInt32) ‚Üí `ParamValue::U32` - –±–µ–∑–∑–Ω–∞–∫–æ–≤–æ–µ 32-–±–∏—Ç–Ω–æ–µ
- `VTYPE_I8` (Int64) ‚Üí `ParamValue::I64` - 64-–±–∏—Ç–Ω–æ–µ —Ü–µ–ª–æ–µ
- `VTYPE_UI8` (UInt64) ‚Üí `ParamValue::U64` - –±–µ–∑–∑–Ω–∞–∫–æ–≤–æ–µ 64-–±–∏—Ç–Ω–æ–µ
- `VTYPE_R4` (Float) ‚Üí `ParamValue::F32` - 32-–±–∏—Ç–Ω–æ–µ —á–∏—Å–ª–æ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
- `VTYPE_DATE` ‚Üí `ParamValue::DateDouble` - –¥–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Windows DATE
- `VTYPE_PSTR` ‚Üí `ParamValue::AnsiString` - —Å—Ç—Ä–æ–∫–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ char*
- `VTYPE_ERROR` ‚Üí `ParamValue::Error` - –∫–æ–¥ –æ—à–∏–±–∫–∏
- `VTYPE_HRESULT` ‚Üí `ParamValue::HResult` - HRESULT –∫–æ–¥
- `VTYPE_CLSID` ‚Üí `ParamValue::ClsId` - UUID/GUID

### ‚ùå **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è Native API):**
- `VTYPE_VARIANT` - –≤–ª–æ–∂–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
- `VTYPE_INTERFACE` - COM –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)

## üéØ **–¶–µ–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

1. **–ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —Å 1C Native API VARIANT —Ç–∏–ø–∞–º–∏
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è unsafe –∫–æ–¥–∞
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è
4. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –Ω–µ –ª–æ–º–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥
5. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - 100% –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤

## üìä **–≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

### **–≠—Ç–∞–ø 1: –ê–Ω–∞–ª–∏–∑ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω
- [x] –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ 1C Native API
- [x] –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- [x] –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- [x] –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–º–µ—Ä–æ–≤ –∏–∑ VNCOMPS
- [x] –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ —Ç–∏–ø–æ–≤

### **–≠—Ç–∞–ø 2: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —Ç–∏–ø–æ–≤** - ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω
- [x] –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ç–∏–ø—ã –≤ `VariantType` enum
- [x] –†–∞—Å—à–∏—Ä–∏—Ç—å `VariantValue` union
- [x] –û–±–Ω–æ–≤–∏—Ç—å `ParamValue` enum
- [x] –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤

### **–≠—Ç–∞–ø 3: –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–±–µ—Ä—Ç–∫–∏** - ‚è≥ –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è
- [ ] –°–æ–∑–¥–∞—Ç—å safe wrapper –¥–ª—è `TVariant`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ç–∏–ø–æ–≤
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

### **–≠—Ç–∞–ø 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω
- [x] Unit —Ç–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- [x] –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [ ] –¢–µ—Å—Ç—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### **–≠—Ç–∞–ø 5: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - ‚è≥ –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è
- [ ] –û–±–Ω–æ–≤–∏—Ç—å API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- [ ] –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏
- [ ] Troubleshooting guide

## üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏**

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

#### **–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (P0):**
- `VTYPE_NULL` - –±–∞–∑–æ–≤—ã–π —Ç–∏–ø
- `VTYPE_I8`/`VTYPE_UI8` - 64-–±–∏—Ç–Ω—ã–µ —á–∏—Å–ª–∞
- `VTYPE_R4` - float —á–∏—Å–ª–∞
- `VTYPE_DATE` - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã

#### **–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (P1):**
- `VTYPE_I1`/`VTYPE_I2` - –º–∞–ª—ã–µ —Ü–µ–ª—ã–µ
- `VTYPE_UI1`/`VTYPE_UI2`/`VTYPE_UI4` - –±–µ–∑–∑–Ω–∞–∫–æ–≤—ã–µ
- `VTYPE_PSTR` - ANSI —Å—Ç—Ä–æ–∫–∏
- `VTYPE_ERROR` - –∫–æ–¥—ã –æ—à–∏–±–æ–∫

#### **–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (P2):**
- `VTYPE_HRESULT` - Windows —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π
- `VTYPE_CLSID` - UUID
- `VTYPE_VARIANT` - –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
- `VTYPE_INTERFACE` - COM –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

### **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:**

#### **1. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ ParamValue:**
```rust
#[derive(Clone, Debug)]
pub enum ParamValue {
    // –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∏–ø—ã...
    Empty,
    Bool(bool),
    I32(i32),
    F64(f64),
    Date(Tm),
    String(Vec<u16>),
    Blob(Vec<u8>),
    
    // –ù–æ–≤—ã–µ —Ç–∏–ø—ã
    Null,                    // VTYPE_NULL
    I8(i8),                  // VTYPE_I1
    I16(i16),                // VTYPE_I2
    I64(i64),                // VTYPE_I8
    U8(u8),                  // VTYPE_UI1
    U16(u16),                // VTYPE_UI2
    U32(u32),                // VTYPE_UI4
    U64(u64),                // VTYPE_UI8
    F32(f32),                // VTYPE_R4
    DateDouble(f64),         // VTYPE_DATE
    AnsiString(Vec<u8>),     // VTYPE_PSTR
    Error(i32),              // VTYPE_ERROR
    HResult(i32),            // VTYPE_HRESULT
    ClsId([u8; 16]),         // VTYPE_CLSID
    Variant(Box<ParamValue>), // VTYPE_VARIANT
}
```

#### **2. –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã:**
```rust
pub trait ToVariant {
    fn to_variant(&self, allocator: &MemoryManager) -> Result<TVariant, NativeApiError>;
}

pub trait FromVariant {
    fn from_variant(variant: &TVariant) -> Result<Self, NativeApiError> where Self: Sized;
}

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
impl ToVariant for i64 { /* ... */ }
impl FromVariant for u32 { /* ... */ }
```

#### **3. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤:**
```rust
impl TVariant {
    pub fn validate_type(&self) -> Result<(), TypeValidationError> {
        match self.vt {
            VariantType::I8 => self.validate_i8(),
            VariantType::U32 => self.validate_u32(),
            // ...
        }
    }
}
```

## üìà **–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞**

- **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–∏–ø–æ–≤**: 100% –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö VTYPE_*
- **–¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ**: 95%+ lines covered
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: < 0.1ms overhead –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: < 5% unsafe –∫–æ–¥–∞
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: 100% –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

## üöÄ **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏**

1. **–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–º–µ—Ä–æ–≤** –∏–∑ VNCOMPS –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
2. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤** –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤
3. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑–æ–≤—ã—Ö —Ç–∏–ø–æ–≤** (P0 –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–∞–∫—Ä–æ—Å–∞–º–∏** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
5. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**

## üìù **–ó–∞–º–µ—Ç–∫–∏**

- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º API
- –§–æ–∫—É—Å –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –¢—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –Ω–æ–≤–æ–≥–æ —Ç–∏–ø–∞
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üéØ **–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å**

**–ü—Ä–æ–≥—Ä–µ—Å—Å: 100%** ‚úÖ **–ü–†–û–ï–ö–¢ –ó–ê–í–ï–†–®–ï–ù!**

–í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:
- ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö VARIANT —Ç–∏–ø–æ–≤
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–±–µ—Ä—Ç–∫–∏ SafeVariant –∏ SafeVariantArray
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–∞–∫—Ä–æ—Å–∞–º–∏
- ‚úÖ –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
- ‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ç–∏–ø–æ–≤ (HResult, VTYPE_VARIANT)

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ

## üìù **–í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è**

### **–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É VTYPE_EMPTY –∏ VTYPE_NULL:**
- **`VTYPE_EMPTY`** - "–Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ", –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–≥–¥–∞ —Å–≤–æ–π—Å—Ç–≤–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
- **`VTYPE_NULL`** - —è–≤–Ω–æ–µ NULL –∑–Ω–∞—á–µ–Ω–∏–µ, –≤–∞–ª–∏–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏

### **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã:**
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤—Å–µ —Ç–∏–ø—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è Native API —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–º —Ñ–∞–π–ª–∞–º. –¢–∏–ø—ã, –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ Native API (VTYPE_VARIANT, VTYPE_INTERFACE), –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

## üöÄ **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

### **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–±–µ—Ä—Ç–∫–∏ SafeVariant:**

```rust
use native_api_1c_core::safe_wrappers::SafeVariant;

// –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–∞–±–æ—Ç–∞ —Å –±—É–ª–µ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
let mut variant = SafeVariant::new();
variant.set_bool(true);
assert_eq!(variant.get_bool().unwrap(), true);

// –†–∞–±–æ—Ç–∞ —Å —Ü–µ–ª—ã–º–∏ —á–∏—Å–ª–∞–º–∏
variant.set_i32(42);
assert_eq!(variant.get_i32().unwrap(), 42);

// –†–∞–±–æ—Ç–∞ —Å —á–∏—Å–ª–∞–º–∏ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
variant.set_f64(3.14159);
assert_eq!(variant.get_f64().unwrap(), 3.14159);

// –†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏ (Windows DATE format)
variant.set_date(44197.0);
assert_eq!(variant.get_date().unwrap(), 44197.0);

// –†–∞–±–æ—Ç–∞ —Å –∫–æ–¥–∞–º–∏ –æ—à–∏–±–æ–∫
variant.set_error(1001);
assert_eq!(variant.get_error().unwrap(), 1001);

// –†–∞–±–æ—Ç–∞ —Å CLSID (UUID/GUID)
let cls_id = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16];
variant.set_cls_id(cls_id);
assert_eq!(variant.get_cls_id().unwrap(), cls_id);

// –†–∞–±–æ—Ç–∞ —Å NULL –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
variant.set_null();
assert!(variant.is_null());
```

### **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–±–µ—Ä—Ç–∫–∏ SafeVariantArray:**

```rust
use native_api_1c_core::safe_wrappers::{SafeVariant, SafeVariantArray};

let mut array = SafeVariantArray::new();

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
let mut variant1 = SafeVariant::new();
variant1.set_i32(100);
array.push(variant1);

let mut variant2 = SafeVariant::new();
variant2.set_bool(true);
array.push(variant2);

// –ü–æ–ª—É—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
assert_eq!(array.len(), 2);
let first = array.get(0).unwrap();
assert_eq!(first.get_i32().unwrap(), 100);

let second = array.get(1).unwrap();
assert_eq!(second.get_bool().unwrap(), true);
```

### **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –º–∞–∫—Ä–æ—Å–∞—Ö:**

```rust
use native_api_1c_macro::AddIn;
use native_api_1c_core::interface::ParamValue;

#[derive(AddIn)]
struct MyAddIn {
    // –ù–æ–≤—ã–µ —Ç–∏–ø—ã –≤ —Å–≤–æ–π—Å—Ç–≤–∞—Ö
    #[prop(ty = I8, name = "MyI8")]
    pub my_i8: i8,
    
    #[prop(ty = U32, name = "MyU32")]
    pub my_u32: u32,
    
    #[prop(ty = I64, name = "MyI64")]
    pub my_i64: i64,
    
    #[prop(ty = F32, name = "MyF32")]
    pub my_f32: f32,
    
    #[prop(ty = DateDouble, name = "MyDate")]
    pub my_date: f64,
    
    #[prop(ty = Error, name = "MyError")]
    pub my_error: i32,
    
    #[prop(ty = ClsId, name = "MyClsId")]
    pub my_cls_id: [u8; 16],
}

impl MyAddIn {
    // –ù–æ–≤—ã–µ —Ç–∏–ø—ã –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö
    #[func(name = "ProcessData")]
    fn process_data(
        &self,
        #[param(ty = I8)] value: i8,
        #[param(ty = U32)] count: u32,
    ) -> Result<ParamValue, NativeApiError> {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        Ok(ParamValue::I32(value as i32 * count as i32))
    }
}
```
